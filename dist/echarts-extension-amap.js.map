{"version":3,"file":"echarts-extension-amap.js","sources":["../src/helper.js","../src/AMapCoordSys.js","../src/AMapModel.js","../src/AMapView.js","../src/index.js","../index.js"],"sourcesContent":["import { version } from 'echarts/lib/echarts'\n\nexport const ecVer = version.split('.')\n\nexport const isNewEC = ecVer[0] > 4\n\nexport const COMPONENT_TYPE = 'amap'\n\n/* global AMap */\n\n// The version property is `AMap.v` in AMap 1.x,\n// but `AMap.version` may also exist (See #51)\n// In AMap 2.x, it's `AMap.version` (Not sure if `AMap.v` exists)\n// use function instead of constant to allow importing the plugin before AMap is loaded\nexport const isAMap2X = () => !AMap.v && AMap.version && AMap.version.split('.')[0] >= 2\n\nexport function v2Equal(a, b) {\n  return a && b && a[0] === b[0] && a[1] === b[1]\n}\n\nlet logMap = {}\n\nexport function logWarn(tag, msg, once) {\n  const log = `[ECharts][Extension][AMap]${tag ? ' ' + tag + ':' : ''} ${msg}`\n  once && logMap[log] || console.warn(log)\n  once && (logMap[log] = true)\n}\n\nexport function clearLogMap() {\n  logMap = {}\n}\n","import { util as zrUtil, graphic, matrix } from 'echarts/lib/echarts'\nimport { COMPONENT_TYPE, logWarn } from './helper'\n\nfunction dataToCoordSize(dataSize, dataItem) {\n  dataItem = dataItem || [0, 0];\n  return zrUtil.map(\n    [0, 1],\n    function(dimIdx) {\n      const val = dataItem[dimIdx]\n      const halfSize = dataSize[dimIdx] / 2\n      const p1 = []\n      const p2 = []\n      p1[dimIdx] = val - halfSize\n      p2[dimIdx] = val + halfSize\n      p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx]\n      return Math.abs(\n        this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]\n      )\n    },\n    this\n  )\n}\n\n// exclude private and unsupported options\nconst excludedOptions = [\n  'echartsLayerZIndex', // DEPRECATED since v1.9.0\n  'echartsLayerInteractive',\n  'renderOnMoving',\n  'largeMode',\n  'returnMapCameraState',\n  'layers'\n]\n\nfunction AMapCoordSys(amap, api) {\n  this._amap = amap\n  this._api = api\n  this._mapOffset = [0, 0]\n  // this.dimensions = ['lng', 'lat']\n}\n\nconst AMapCoordSysProto = AMapCoordSys.prototype\n\nAMapCoordSysProto.setZoom = function(zoom) {\n  this._zoom = zoom\n}\n\nAMapCoordSysProto.setCenter = function(center) {\n  const lnglat = new AMap.LngLat(center[0], center[1])\n  this._center = this._amap.lngLatToContainer(lnglat)\n}\n\nAMapCoordSysProto.setMapOffset = function(mapOffset) {\n  this._mapOffset = mapOffset\n}\n\nAMapCoordSysProto.setAMap = function(amap) {\n  this._amap = amap\n}\n\nAMapCoordSysProto.getAMap = function() {\n  return this._amap\n}\n\nAMapCoordSysProto.dataToPoint = function(data) {\n  const lnglat = new AMap.LngLat(data[0], data[1])\n  const px = this._amap.lngLatToContainer(lnglat)\n  const mapOffset = this._mapOffset\n  return [px.x - mapOffset[0], px.y - mapOffset[1]]\n}\n\nAMapCoordSysProto.pointToData = function(pt) {\n  const mapOffset = this._mapOffset\n  const lnglat = this._amap.containerToLngLat(\n    new AMap.Pixel(\n      pt[0] + mapOffset[0],\n      pt[1] + mapOffset[1]\n    )\n  )\n  return [lnglat.lng, lnglat.lat]\n}\n\nAMapCoordSysProto.getViewRect = function() {\n  const api = this._api\n  return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight())\n}\n\nAMapCoordSysProto.getRoamTransform = function() {\n  return matrix.create()\n}\n\nAMapCoordSysProto.prepareCustoms = function() {\n  const rect = this.getViewRect()\n  return {\n    coordSys: {\n      type: COMPONENT_TYPE,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    api: {\n      coord: zrUtil.bind(this.dataToPoint, this),\n      size: zrUtil.bind(dataToCoordSize, this)\n    }\n  }\n}\n\nAMapCoordSysProto.convertToPixel = function(ecModel, finder, value) {\n  // here we don't use finder as only one amap component is allowed\n  return this.dataToPoint(value);\n}\n\nAMapCoordSysProto.convertFromPixel = function(ecModel, finder, value) {\n  // here we don't use finder as only one amap component is allowed\n  return this.pointToData(value);\n}\n\n// less useful\n// AMapCoordSysProto.containPoint = function(point) {\n//   return this._amap.getBounds().contains(this.pointToData(point));\n// }\n\nAMapCoordSys.create = function(ecModel, api) {\n  let amapCoordSys\n  ecModel.eachComponent(COMPONENT_TYPE, function(amapModel) {\n    if (typeof AMap === 'undefined') {\n      throw new Error('AMap api is not loaded')\n    }\n    if (amapCoordSys) {\n      throw new Error('Only one amap component is allowed')\n    }\n    let amap = amapModel.getAMap()\n    const echartsLayerInteractive = amapModel.get('echartsLayerInteractive')\n    if (!amap) {\n      const root = api.getDom()\n      const painter = api.getZr().painter\n      const viewportRoot = painter.getViewportRoot()\n      viewportRoot.className = COMPONENT_TYPE + '-ec-layer'\n      // PENDING not hidden?\n      viewportRoot.style.visibility = 'hidden'\n      const className = 'ec-extension-' + COMPONENT_TYPE\n      // Not support IE8\n      let amapRoot = root.querySelector('.' + className)\n      if (amapRoot) {\n        // Reset viewport left and top, which will be changed\n        // in moving handler in AMapView\n        viewportRoot.style.left = '0px'\n        viewportRoot.style.top = '0px'\n        root.removeChild(amapRoot)\n      }\n      amapRoot = document.createElement('div')\n      amapRoot.className = className\n      amapRoot.style.cssText = 'position:absolute;top:0;left:0;bottom:0;right:0;'\n      root.appendChild(amapRoot)\n\n      const options = zrUtil.clone(amapModel.get())\n      if ('echartsLayerZIndex' in options) {\n        logWarn('DEPRECATED', 'the option `echartsLayerZIndex` has been removed since v1.9.0, use `echartsLayerInteractive` instead.')\n      }\n      // delete excluded options\n      zrUtil.each(excludedOptions, function(key) {\n        delete options[key]\n      })\n\n      amap = new AMap.Map(amapRoot, options)\n\n      // PENDING: should update the model option when the user call map.setXXX?\n\n      // const nativeSetMapStyle = amap.setMapStyle\n      // const nativeSetLang = amap.setLang\n\n      // // PENDING\n      // amap.setMapStyle = function () {\n      //   nativeSetMapStyle.apply(this, arguments)\n      //   amapModel.__mapStyle = amap.getMapStyle()\n      // }\n\n      // // PENDING\n      // nativeSetLang && (amap.setLang = function() {\n      //   nativeSetLang.apply(this, arguments)\n      //   amapModel.__mapLang = amap.getLang()\n      // })\n\n      // use `complete` callback to avoid NPE when first load amap\n      amap.on('complete', function() {\n        amapRoot.querySelector('.amap-maps').appendChild(viewportRoot)\n        // PENDING\n        viewportRoot.style.visibility = ''\n      })\n\n      amapModel.setAMap(amap)\n      amapModel.setEChartsLayer(viewportRoot)\n\n      // Override\n      painter.getViewportRootOffset = function() {\n        return { offsetLeft: 0, offsetTop: 0 }\n      }\n    }\n\n    const oldEChartsLayerInteractive = amapModel.__echartsLayerInteractive\n    if (oldEChartsLayerInteractive !== echartsLayerInteractive) {\n      amapModel.setEChartsLayerInteractive(echartsLayerInteractive)\n      amapModel.__echartsLayerInteractive = echartsLayerInteractive\n    }\n\n    const center = amapModel.get('center')\n    const zoom = amapModel.get('zoom')\n    if (center && zoom) {\n      const amapCenter = amap.getCenter()\n      const amapZoom = amap.getZoom()\n      const centerOrZoomChanged = amapModel.centerOrZoomChanged(\n        [amapCenter.lng, amapCenter.lat],\n        amapZoom\n      )\n      if (centerOrZoomChanged) {\n        amap.setZoomAndCenter(zoom, new AMap.LngLat(center[0], center[1]))\n      }\n    }\n\n    // update map style(#13)\n    const originalMapStyle = amapModel.__mapStyle\n    const newMapStyle = amapModel.get('mapStyle')\n    if (originalMapStyle !== newMapStyle) {\n      amap.setMapStyle(amapModel.__mapStyle = newMapStyle)\n    }\n\n    // update map lang\n    // PENDING: AMap 2.x does not support `setLang` yet\n    if (amap.setLang) {\n      const originalMapLang = amapModel.__mapLang\n      const newMapLang = amapModel.get('lang')\n      if (originalMapLang !== newMapLang) {\n        amap.setLang(amapModel.__mapLang = newMapLang)\n      }\n    }\n    else {\n      logWarn('CAVEAT', 'The current map doesn\\'t support `setLang` API!', true)\n    }\n\n    amapCoordSys = new AMapCoordSys(amap, api)\n    amapCoordSys.setMapOffset(amapModel.__mapOffset || [0, 0])\n    amapCoordSys.setZoom(zoom)\n    amapCoordSys.setCenter(center)\n\n    amapModel.coordinateSystem = amapCoordSys\n  })\n\n  ecModel.eachSeries(function(seriesModel) {\n    if (seriesModel.get('coordinateSystem') === COMPONENT_TYPE) {\n      // inject coordinate system\n      seriesModel.coordinateSystem = amapCoordSys\n    }\n  })\n\n  // return created coordinate systems\n  return amapCoordSys && [amapCoordSys]\n}\n\nAMapCoordSysProto.dimensions = AMapCoordSys.dimensions = ['lng', 'lat']\n\nAMapCoordSysProto.type = COMPONENT_TYPE\n\n\nexport default AMapCoordSys\n","import { ComponentModel } from 'echarts/lib/echarts'\nimport { COMPONENT_TYPE, isNewEC, v2Equal } from './helper'\n\nconst AMapModel = {\n  type: COMPONENT_TYPE,\n\n  setAMap(amap) {\n    this.__amap = amap\n  },\n\n  getAMap() {\n    return this.__amap\n  },\n\n  setEChartsLayer(layer) {\n    this.__echartsLayer = layer\n  },\n\n  getEChartsLayer() {\n    return this.__echartsLayer\n  },\n\n  setEChartsLayerVisibility(visible) {\n    this.__echartsLayer.style.display = visible ? 'block' : 'none'\n  },\n\n  // FIXME: NOT SUPPORT <= IE 10\n  setEChartsLayerInteractive(interactive) {\n    this.option.echartsLayerInteractive = !!interactive\n    this.__echartsLayer.style.pointerEvents = interactive ? 'auto' : 'none'\n  },\n\n  setCenterAndZoom(center, zoom) {\n    this.option.center = center\n    this.option.zoom = zoom\n  },\n\n  centerOrZoomChanged(center, zoom) {\n    const option = this.option\n    return !(v2Equal(center, option.center) && zoom === option.zoom)\n  },\n\n  defaultOption: {\n    center: [116.397428, 39.90923],\n    zoom: 5,\n    isHotspot: false,\n    resizeEnable: true,\n\n    // extension specific options\n    // echartsLayerZIndex: 2000, // DEPRECATED since v1.9.0\n    echartsLayerInteractive: true,\n    renderOnMoving: true,\n    largeMode: false,\n    // since v1.10.0\n    returnMapCameraState: false\n  }\n}\n\nexport default isNewEC\n  ? ComponentModel.extend(AMapModel)\n  : AMapModel\n","import { ComponentView, getInstanceByDom, throttle } from 'echarts/lib/echarts'\nimport { COMPONENT_TYPE, isNewEC, isAMap2X, clearLogMap } from './helper'\n\nlet _isAMap2X\n\nconst AMapView = {\n  type: COMPONENT_TYPE,\n\n  init() {\n    this._isFirstRender = true\n\n    _isAMap2X = isAMap2X()\n  },\n\n  render(amapModel, ecModel, api) {\n    let rendering = true\n\n    const amap = amapModel.getAMap()\n    const viewportRoot = api.getZr().painter.getViewportRoot()\n    const offsetEl = amap.getContainer()\n    const coordSys = amapModel.coordinateSystem\n\n    const renderOnMoving = amapModel.get('renderOnMoving')\n    const resizeEnable = amapModel.get('resizeEnable')\n    const largeMode = amapModel.get('largeMode')\n    const returnMapCameraState = amapModel.get('returnMapCameraState')\n\n    const viewMode = amap.getViewMode_()\n    const is3DMode = viewMode === '3D'\n\n    let moveHandler = function(e) {\n      if (rendering) {\n        return\n      }\n\n      const offsetElStyle = offsetEl.style\n      const mapOffset = [\n        -parseInt(offsetElStyle.left, 10) || 0,\n        -parseInt(offsetElStyle.top, 10) || 0\n      ]\n      // only update style when map offset changed\n      const viewportRootStyle = viewportRoot.style\n      const offsetLeft = mapOffset[0] + 'px'\n      const offsetTop = mapOffset[1] + 'px'\n      if (viewportRootStyle.left !== offsetLeft) {\n        viewportRootStyle.left = offsetLeft\n      }\n      if (viewportRootStyle.top !== offsetTop) {\n        viewportRootStyle.top = offsetTop\n      }\n\n      coordSys.setMapOffset(amapModel.__mapOffset = mapOffset)\n\n      const actionParams = {\n        type: 'amapRoam',\n        animation: {\n          // compatible with ECharts 5.x\n          // no delay for rendering but remain animation of elements\n          duration: 0\n        }\n      }\n\n      if (returnMapCameraState) {\n        e = e || {}\n        let center = e.center\n        if (!center) {\n          // normalize center LngLat to Array\n          center = amap.getCenter()\n          center = [center.lng, center.lat]\n        }\n        actionParams.camera = {\n          viewMode,\n          center,\n          zoom: e.zoom || amap.getZoom(),\n          rotation: e.rotation == null ? amap.getRotation() : e.rotation,\n          pitch: e.pitch == null ? amap.getPitch() : e.pitch,\n          scale: amap.getScale(),\n          bounds: amap.getBounds()\n        }\n      }\n\n      api.dispatchAction(actionParams)\n    }\n\n    amap.off('mapmove', this._moveHandler)\n    amap.off('moveend', this._moveHandler)\n    amap.off('viewchange', this._moveHandler)\n    amap.off('camerachange', this._moveHandler)\n    amap.off('zoom', this._moveHandler)\n\n    if (this._resizeHandler) {\n      amap.off('resize', this._resizeHandler)\n    }\n    if (this._moveStartHandler) {\n      amap.off('movestart', this._moveStartHandler)\n    }\n    if (this._moveEndHandler) {\n      amap.off('moveend', this._moveEndHandler)\n      amap.off('zoomend', this._moveEndHandler)\n    }\n\n    amap.on(\n      renderOnMoving\n        ? (_isAMap2X\n          ? 'viewchange'\n          : is3DMode\n            ? 'camerachange'\n            : 'mapmove')\n        : 'moveend',\n      // FIXME: bad performance in 1.x in the cases with large data, use debounce?\n      // moveHandler\n      (!_isAMap2X && largeMode) ? (moveHandler = throttle(moveHandler, 20, true)) : moveHandler\n    )\n\n    this._moveHandler = moveHandler\n\n    if (renderOnMoving && !(_isAMap2X && is3DMode)) {\n      // need to listen to zoom if 1.x & 2D mode\n      // FIXME: unnecessary `mapmove` event triggered when zooming\n      amap.on('zoom', moveHandler)\n    }\n\n    if (!renderOnMoving) {\n      amap.on('movestart', this._moveStartHandler = function() {\n        setTimeout(function() {\n          amapModel.setEChartsLayerVisibility(false)\n        }, 0)\n      })\n      const moveEndHandler = this._moveEndHandler = function(e) {\n        ;(!e || e.type !== 'moveend') && moveHandler(e)\n        setTimeout(function() {\n          amapModel.setEChartsLayerVisibility(true)\n        }, _isAMap2X || !largeMode ? 0 : 20)\n      }\n      amap.on('moveend', moveEndHandler)\n      amap.on('zoomend', moveEndHandler)\n      if (this._isFirstRender && is3DMode) {\n        // FIXME: not rewrite AMap instance method\n        const nativeSetPitch = amap.setPitch\n        const nativeSetRotation = amap.setRotation\n        amap.setPitch = function() {\n          nativeSetPitch.apply(this, arguments)\n          moveEndHandler()\n        }\n        amap.setRotation = function() {\n          nativeSetRotation.apply(this, arguments)\n          moveEndHandler()\n        }\n      }\n    }\n\n    if (resizeEnable) {\n      let resizeHandler = () => {\n        clearTimeout(this._resizeTimeout)\n        this._resizeTimeout = setTimeout(() => getInstanceByDom(api.getDom()).resize(), 0)\n      }\n      if (!_isAMap2X && largeMode) {\n        resizeHandler = throttle(resizeHandler, 20, true)\n      }\n      amap.on('resize', this._resizeHandler = resizeHandler)\n    }\n\n    this._isFirstRender = rendering = false\n  },\n\n  dispose() {\n    clearTimeout(this._resizeTimeout)\n    clearLogMap()\n    const component = this.__model\n    if (component) {\n      component.getAMap().destroy()\n      component.setAMap(null)\n      component.setEChartsLayer(null)\n      if (component.coordinateSystem) {\n        component.coordinateSystem.setAMap(null)\n        component.coordinateSystem = null\n      }\n    }\n    delete this._moveHandler\n    delete this._moveStartHandler\n    delete this._moveEndHandler\n    delete this._resizeHandler\n    delete this._resizeTimeout\n  }\n}\n\nexport default isNewEC\n  ? ComponentView.extend(AMapView)\n  : AMapView\n","/**\n * AMap component extension\n */\n\nimport AMapCoordSys from './AMapCoordSys'\nimport AMapModel from './AMapModel'\nimport AMapView from './AMapView'\nimport { isNewEC, ecVer, COMPONENT_TYPE } from './helper'\n\nexport { version, name } from '../package.json'\n\n/**\n * @typedef {import('../export').EChartsExtensionRegisters} EChartsExtensionRegisters\n */\n\n/**\n * AMap extension installer\n * @param {EChartsExtensionRegisters} registers\n */\nexport function install(registers) {\n  // add coordinate system support for pie series for ECharts < 5.4.0\n  if (!isNewEC || (ecVer[0] == 5 && ecVer[1] < 4)) {\n    registers.registerLayout(function(ecModel) {\n      ecModel.eachSeriesByType('pie', function (seriesModel) {\n        const coordSys = seriesModel.coordinateSystem\n        const data = seriesModel.getData()\n        const valueDim = data.mapDimension('value')\n        if (coordSys && coordSys.type === COMPONENT_TYPE) {\n          const center = seriesModel.get('center')\n          const point = coordSys.dataToPoint(center)\n          const cx = point[0]\n          const cy = point[1]\n          data.each(valueDim, function (value, idx) {\n            const layout = data.getItemLayout(idx)\n            layout.cx = cx\n            layout.cy = cy\n          })\n        }\n      })\n    })\n  }\n  // Model\n  isNewEC\n    ? registers.registerComponentModel(AMapModel)\n    : registers.extendComponentModel(AMapModel)\n  // View\n  isNewEC\n    ? registers.registerComponentView(AMapView)\n    : registers.extendComponentView(AMapView)\n  // Coordinate System\n  registers.registerCoordinateSystem(COMPONENT_TYPE, AMapCoordSys)\n  // Action\n  registers.registerAction(\n    {\n      type: COMPONENT_TYPE + 'Roam',\n      event: COMPONENT_TYPE + 'Roam',\n      update: 'updateLayout'\n    },\n    function(payload, ecModel) {\n      ecModel.eachComponent(COMPONENT_TYPE, function(amapModel) {\n        const amap = amapModel.getAMap()\n        const center = amap.getCenter()\n        amapModel.setCenterAndZoom([center.lng, center.lat], amap.getZoom())\n      })\n    }\n  )\n}\n","/**\n * TODO use `echarts/core` rather than `echarts/lib/echarts`\n * to avoid self-registered `CanvasRenderer` and `DataSetComponent` in Apache ECharts 5\n * but it's not compatible with echarts v4. Leave it to 2.0.\n */\nimport * as echarts from 'echarts/lib/echarts'\nimport { install } from './src/index'\nimport { isNewEC } from './src/helper'\n\nisNewEC ? echarts.use(install) : install(echarts)\n\nexport { name, version } from './src/index'\n"],"names":["ecVer","version","split","isNewEC","COMPONENT_TYPE","isAMap2X","AMap","v","v2Equal","a","b","logMap","logWarn","tag","msg","once","log","concat","console","warn","clearLogMap","dataToCoordSize","dataSize","dataItem","zrUtil","map","dimIdx","val","halfSize","p1","p2","Math","abs","dataToPoint","excludedOptions","AMapCoordSys","amap","api","_amap","_api","_mapOffset","AMapCoordSysProto","prototype","setZoom","zoom","_zoom","setCenter","center","lnglat","LngLat","_center","lngLatToContainer","setMapOffset","mapOffset","setAMap","getAMap","data","px","x","y","pointToData","pt","containerToLngLat","Pixel","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","bind","size","convertToPixel","ecModel","finder","value","convertFromPixel","amapCoordSys","eachComponent","amapModel","Error","echartsLayerInteractive","get","root","getDom","painter","getZr","viewportRoot","getViewportRoot","className","style","visibility","amapRoot","querySelector","left","top","removeChild","document","createElement","cssText","appendChild","options","clone","each","key","Map","on","setEChartsLayer","getViewportRootOffset","offsetLeft","offsetTop","oldEChartsLayerInteractive","__echartsLayerInteractive","setEChartsLayerInteractive","amapCenter","getCenter","amapZoom","getZoom","centerOrZoomChanged","setZoomAndCenter","originalMapStyle","__mapStyle","newMapStyle","setMapStyle","setLang","originalMapLang","__mapLang","newMapLang","__mapOffset","coordinateSystem","eachSeries","seriesModel","dimensions","AMapModel","__amap","layer","__echartsLayer","getEChartsLayer","setEChartsLayerVisibility","visible","display","interactive","option","pointerEvents","setCenterAndZoom","defaultOption","isHotspot","resizeEnable","renderOnMoving","largeMode","returnMapCameraState","ComponentModel","extend","_isAMap2X","AMapView","init","_isFirstRender","render","_this","rendering","offsetEl","getContainer","viewMode","getViewMode_","is3DMode","moveHandler","e","offsetElStyle","parseInt","viewportRootStyle","actionParams","animation","duration","camera","rotation","getRotation","pitch","getPitch","scale","getScale","bounds","getBounds","dispatchAction","off","_moveHandler","_resizeHandler","_moveStartHandler","_moveEndHandler","throttle","setTimeout","moveEndHandler","nativeSetPitch","setPitch","nativeSetRotation","setRotation","apply","arguments","resizeHandler","clearTimeout","_resizeTimeout","getInstanceByDom","resize","dispose","component","__model","destroy","ComponentView","install","registers","registerLayout","eachSeriesByType","getData","valueDim","mapDimension","point","cx","cy","idx","layout","getItemLayout","registerComponentModel","extendComponentModel","registerComponentView","extendComponentView","registerCoordinateSystem","registerAction","event","update","payload","echarts","use"],"mappings":"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"}